-----

# PHITS蛹ｻ逋ら畑繝ｪ繝九い繝・け邱夐㍼蛻・ｸ・ｩ穂ｾ｡繝・・繝ｫ

[](https://www.python.org/downloads/)

縺薙・繝励Ο繧ｸ繧ｧ繧ｯ繝医・縲√Δ繝ｳ繝・き繝ｫ繝ｭ險育ｮ励さ繝ｼ繝・**PHITS** 繧堤畑縺・※繧ｷ繝溘Η繝ｬ繝ｼ繧ｷ繝ｧ繝ｳ縺励◆蛹ｻ逋ら畑繝ｪ繝九い繝・け縺ｮ邱夐㍼蛻・ｸ・→縲∝ｮ滄圀縺ｫ貂ｬ螳壹＠縺溽ｷ夐㍼蛻・ｸ・ョ繝ｼ繧ｿ繧呈ｯ碑ｼ・・隧穂ｾ｡縺吶ｋ縺溘ａ縺ｮPython繧ｹ繧ｯ繝ｪ繝励ヨ繧呈署萓帙＠縺ｾ縺吶・
蛹ｻ蟄ｦ迚ｩ逅・・迴ｾ蝣ｴ縲∫音縺ｫ謾ｾ蟆・ｷ壽ｲｻ逋ゅ↓縺翫￠繧句刀雉ｪ菫晁ｨｼ(QA)縺ｧ譌･蟶ｸ逧・↓陦後ｏ繧後ｋ縲瑚ｨ育ｮ怜､縺ｨ螳滓ｸｬ蛟､縺ｮ豈碑ｼ・阪ｒ縲∫皮ｩｶ繝ｬ繝吶Ν縺ｧ螳溯ｷｵ縺吶ｋ縺溘ａ縺ｮ繝・・繝ｫ縺ｧ縺吶・
-----

## 溌 縺薙・繝・・繝ｫ縺ｧ蜃ｺ譚･繧九％縺ｨ

  * **邱夐㍼蛻・ｸ・・豈碑ｼ・** PHITS縺ｮ蜃ｺ蜉帙ヵ繧｡繧､繝ｫ(`.out`)縺ｨ螳滓ｸｬ縺ｮCSV繝輔ぃ繧､繝ｫ繧定ｪｭ縺ｿ霎ｼ縺ｿ縲∫ｷ夐㍼繝励Ο繝輔ぃ繧､繝ｫ繧呈ｯ碑ｼ・＠縺ｾ縺吶・  * **繝・・繧ｿ陬懈ｭ｣讖溯・:**
      * **繧ｹ繧ｱ繝ｼ繝ｪ繝ｳ繧ｰ:** 繧ｷ繝溘Η繝ｬ繝ｼ繧ｷ繝ｧ繝ｳ邨先棡蜈ｨ菴薙↓菫よ焚繧呈寺縺代※縲∝ｮ滓ｸｬ蛟､縺ｨ縺ｮ邨ｶ蟇ｾ逧・↑邱夐㍼蟾ｮ繧定｣懈ｭ｣縺ｧ縺阪∪縺吶・      * **蟷ｳ貊大喧 (繧ｹ繝繝ｼ繧ｸ繝ｳ繧ｰ):** [Savitzky-Golay繝輔ぅ繝ｫ繧ｿ繝ｼ](https://en.wikipedia.org/wiki/Savitzky%E2%80%93Golay_filter)繧堤畑縺・※縲√Δ繝ｳ繝・き繝ｫ繝ｭ險育ｮ礼音譛峨・邨ｱ險医ヮ繧､繧ｺ繧剃ｽ取ｸ帙＠縺ｾ縺吶・  * **隧穂ｾ｡謖・ｨ吶・險育ｮ・**
      * **繧ｬ繝ｳ繝槭う繝ｳ繝・ャ繧ｯ繧ｹ (ﾎｳ-Index)隧穂ｾ｡:** 謾ｾ蟆・ｷ壽ｲｻ逋ょ・驥弱〒讓呎ｺ也噪縺ｫ逕ｨ縺・ｉ繧後ｋ隧穂ｾ｡謖・ｨ吶〒縺吶ゅ檎ｷ夐㍼蟾ｮ(DD)縲阪→縲御ｽ咲ｽｮ縺壹ｌ(DTA)縲阪ｒ蜷梧凾縺ｫ隧穂ｾ｡縺励・縺､縺ｮ邱夐㍼蛻・ｸ・′縺ｩ縺ｮ遞句ｺｦ荳閾ｴ縺励※縺・ｋ縺九ｒ繝代・繧ｻ繝ｳ繝・・繧ｸ・医ヱ繧ｹ邇・ｼ峨〒遉ｺ縺励∪縺吶・      * **RMSE (Root Mean Square Error):** 蟷ｳ蝮・ｺ御ｹ怜ｹｳ譁ｹ譬ｹ隱､蟾ｮ繧定ｨ育ｮ励＠縲∝・菴鍋噪縺ｪ隱､蟾ｮ縺ｮ螟ｧ縺阪＆繧貞ｮ夐㍼逧・↓隧穂ｾ｡縺励∪縺吶・  * **邨先棡縺ｮ閾ｪ蜍募・蜉・**
      * 豈碑ｼ・ｵ先棡繧定ｦ冶ｦ夂噪縺ｫ遒ｺ隱阪〒縺阪ｋ繧ｰ繝ｩ繝慕判蜒・(`.png`)
      * 菴ｿ逕ｨ縺励◆繝代Λ繝｡繝ｼ繧ｿ繧・ｩ穂ｾ｡邨先棡繧偵∪縺ｨ繧√◆繝ｬ繝昴・繝・(`.txt`)

-----

## 伐 蛹ｻ蟄ｦ迚ｩ逅・ン繧ｮ繝翫・蜷代￠隗｣隱ｬ

### 縺ｪ縺懊す繝溘Η繝ｬ繝ｼ繧ｷ繝ｧ繝ｳ縺ｨ螳滓ｸｬ繧呈ｯ斐∋繧九・・・
謾ｾ蟆・ｷ壽ｲｻ逋ゅ〒縺ｯ縲√さ繝ｳ繝斐Η繝ｼ繧ｿ・域ｲｻ逋りｨ育判陬・ｽｮ, TPS・我ｸ翫〒險育ｮ励＆繧後◆邱夐㍼蛻・ｸ・′縲∝ｮ滄圀縺ｫ謔｣閠・＆繧薙・菴灘・縺ｧ螳溽樟縺輔ｌ繧句ｿ・ｦ√′縺ゅｊ縺ｾ縺吶ゅ％縺ｮ縲瑚ｨ育ｮ励′豁｣縺励＞縺九阪ｒ遒ｺ隱阪☆繧倶ｽ懈･ｭ繧・*繧ｳ繝溘ャ繧ｷ繝ｧ繝九Φ繧ｰ**繧Ы*\*蜩∬ｳｪ菫晁ｨｼ(QA)\*\*縺ｨ蜻ｼ縺ｳ縲・撼蟶ｸ縺ｫ驥崎ｦ√〒縺吶・
縺薙・繝励Ο繧ｸ繧ｧ繧ｯ繝医〒縺ｯ縲ゝPS縺ｮ莉｣繧上ｊ縺ｫPHITS繧剃ｽｿ縺・√訓HITS縺ｧ讒狗ｯ峨＠縺溘Μ繝九い繝・け縺ｮ繝｢繝・Ν縺後∵悽迚ｩ縺ｮ繝ｪ繝九い繝・け縺ｮ迚ｹ諤ｧ繧偵←繧後□縺第ｭ｣遒ｺ縺ｫ蜀咲樟縺ｧ縺阪※縺・ｋ縺九阪ｒ讀懆ｨｼ縺励※縺・∪縺吶ゅ％繧後′荳頑焔縺上＞縺代・縲∫黄逅・噪縺ｪ螳滄ｨ薙′髮｣縺励＞讒倥・↑譚｡莉ｶ荳九〒縺ｮ邱夐㍼縺ｮ謖ｯ繧玖・縺・ｒ縲√さ繝ｳ繝斐Η繝ｼ繧ｿ荳翫〒豁｣遒ｺ縺ｫ莠域ｸｬ縺ｧ縺阪ｋ繧医≧縺ｫ縺ｪ繧翫∪縺吶・
### 繧ｬ繝ｳ繝槭う繝ｳ繝・ャ繧ｯ繧ｹ縺ｨ縺ｯ・・
繧ｬ繝ｳ繝槭う繝ｳ繝・ャ繧ｯ繧ｹ縺ｯ縲∫ｷ夐㍼蛻・ｸ・ｒ豈碑ｼ・☆繧九◆繧√・縲後ｂ縺ｮ縺輔＠縲阪・繧医≧縺ｪ繧ゅ・縺ｧ縺吶・
萓九∴縺ｰ縲∝ｮ滓ｸｬ蛟､縺ｧ縲御ｽ咲ｽｮ10mm縺ｮ邱夐㍼縺・00%縲阪□縺｣縺溘→縺励∪縺吶りｨ育ｮ怜､縺後御ｽ咲ｽｮ10mm縺ｧ98%縲阪□縺｣縺溷ｴ蜷医∫ｷ夐㍼蟾ｮ縺ｯ2%縺ｧ縺吶ゅｂ縺苓ｨ育ｮ怜､縺後御ｽ咲ｽｮ10.5mm縺ｧ100%縲阪□縺｣縺溷ｴ蜷医∽ｽ咲ｽｮ縺壹ｌ縺ｯ0.5mm縺ｧ縺吶・
繧ｬ繝ｳ繝櫁ｩ穂ｾ｡縺ｧ縺ｯ縲√・*邱夐㍼蟾ｮ3%莉･蜀・*縲阪°縺､縲・*菴咲ｽｮ縺壹ｌ3mm莉･蜀・*縲阪・繧医≧縺ｫ縲・縺､縺ｮ險ｱ螳ｹ蝓ｺ貅厄ｼ医け繝ｩ繧､繝・Μ繧｢・峨ｒ險ｭ螳壹＠縺ｾ縺吶りｩ穂ｾ｡縺励◆縺・ｨ育ｮ怜､縺ｮ蜷・せ縺後√◎縺ｮ蜻ｨ霎ｺ縺ｫ縺ゅｋ螳滓ｸｬ蛟､縺ｮ縺・★繧後°縺ｨ**荳｡譁ｹ縺ｮ蝓ｺ貅悶ｒ貅縺溘○縺ｰ縲悟粋譬ｼ(ﾎｳ 竕､ 1)縲・*縲∵ｺ縺溘＆縺ｪ縺代ｌ縺ｰ縲御ｸ榊粋譬ｼ(ﾎｳ \> 1)縲阪→縺ｪ繧翫∪縺吶ょ・隧穂ｾ｡轤ｹ縺ｮ縺・■縲∽ｽ・縺悟粋譬ｼ縺励◆縺九ｒ遉ｺ縺励◆縺ｮ縺・*繧ｬ繝ｳ繝槭ヱ繧ｹ邇・*縺ｧ縺吶ゆｸ闊ｬ逧・↓縲・5%莉･荳翫〒縺ゅｌ縺ｰ髱槫ｸｸ縺ｫ濶ｯ縺・ｸ閾ｴ縺ｨ縺輔ｌ縺ｾ縺吶・
### 繧ｹ繧ｯ繝ｪ繝励ヨ縺ｫ縺翫￠繧九ぎ繝ｳ繝櫁ｨ育ｮ・(`pymedphys.gamma`)

縺薙・繧ｹ繧ｯ繝ｪ繝励ヨ縺ｧ縺ｯ縲√ぎ繝ｳ繝櫁ｨ育ｮ励↓`pymedphys`縺ｨ縺・≧蟆る摩繝ｩ繧､繝悶Λ繝ｪ繧剃ｽｿ逕ｨ縺励※縺・∪縺吶ょ・菴鍋噪縺ｫ縺ｯ`pymedphys.gamma`髢｢謨ｰ繧貞他縺ｳ蜃ｺ縺励※縺翫ｊ縲√◎縺ｮ荳ｻ隕√↑蠑墓焚・亥・蜉帙ョ繝ｼ繧ｿ・峨・莉･荳九・騾壹ｊ縺ｧ縺吶・
  * `axes_ref`, `dose_ref`

      * **蜀・ｮｹ:** **螳滓ｸｬ繝・・繧ｿ**縺ｮ蠎ｧ讓呵ｻｸ・・axes_ref`・峨→邱夐㍼蛟､・・dose_ref`・峨〒縺吶・      * **蜊倅ｽ・** 蠎ｧ讓呵ｻｸ縺ｯ\*\*繝溘Μ繝｡繝ｼ繝医Ν (mm)\*\*縺ｧ貂｡縺吝ｿ・ｦ√′縺ゅｊ縺ｾ縺吶・
  * `axes_eval`, `dose_eval`

      * **蜀・ｮｹ:** **PHITS繝・・繧ｿ**縺ｮ蠎ｧ讓呵ｻｸ・・axes_eval`・峨→邱夐㍼蛟､・・dose_eval`・峨〒縺吶・      * **蜊倅ｽ・** 縺薙■繧峨ｂ蠎ｧ讓呵ｻｸ縺ｯ\*\*繝溘Μ繝｡繝ｼ繝医Ν (mm)\*\*縺ｧ縺ゅｋ蠢・ｦ√′縺ゅｊ縺ｾ縺吶・
  * `dose_ta` (Dose To Agreement)

      * **蜀・ｮｹ:** 邱夐㍼蟾ｮ縺ｮ險ｱ螳ｹ蛟､縺ｧ縲√＞繧上ｆ繧欺*\*DD (Dose Difference)\*\*蝓ｺ貅悶〒縺吶・      * **蜊倅ｽ・** \*\*繝代・繧ｻ繝ｳ繝・(%)\*\*縺ｧ謖・ｮ壹＠縺ｾ縺吶ゅ％縺ｮ繝代・繧ｻ繝ｳ繝・・繧ｸ縺ｯ縲∝ｮ滓ｸｬ繝・・繧ｿ縺ｮ譛螟ｧ邱夐㍼縺ｫ蟇ｾ縺吶ｋ蜑ｲ蜷医〒隧穂ｾ｡縺輔ｌ縺ｾ縺吶・
  * `dist_ta` (Distance To Agreement)

      * **蜀・ｮｹ:** 菴咲ｽｮ縺壹ｌ縺ｮ險ｱ螳ｹ蛟､縺ｧ縲√＞繧上ｆ繧欺*\*DTA (Distance To Agreement)\*\*蝓ｺ貅悶〒縺吶・      * **蜊倅ｽ・** \*\*繝溘Μ繝｡繝ｼ繝医Ν (mm)\*\*縺ｧ謖・ｮ壹＠縺ｾ縺吶・
  * `lower_percent_dose_cutoff`

      * **蜀・ｮｹ:** 繧ｬ繝ｳ繝櫁ｩ穂ｾ｡縺ｮ蟇ｾ雎｡縺九ｉ髯､螟悶☆繧倶ｽ守ｷ夐㍼鬆伜沺繧呈欠螳壹＠縺ｾ縺吶ゆｾ九∴縺ｰ`10`繧呈欠螳壹☆繧九→縲∵怙螟ｧ邱夐㍼縺ｮ10%莉･荳九・鬆伜沺縺ｯ隧穂ｾ｡縺輔ｌ縺ｾ縺帙ｓ縲ゅ％繧後・縲√ヮ繧､繧ｺ縺ｮ蠖ｱ髻ｿ縺悟､ｧ縺阪＞菴守ｷ夐㍼驛ｨ縺瑚ｩ穂ｾ｡邨先棡縺ｫ驕主臆縺ｪ蠖ｱ髻ｿ繧剃ｸ弱∴繧九・繧帝亟縺舌◆繧√↓縲∽ｸ闊ｬ逧・↓陦後ｏ繧後ｋ險ｭ螳壹〒縺吶・      * **蜊倅ｽ・** \*\*繝代・繧ｻ繝ｳ繝・(%)\*\*縺ｧ謖・ｮ壹＠縺ｾ縺吶・
-----

## 珍 繧ｻ繝・ヨ繧｢繝・・

### 1\. 蠢・ｦ√↑繧ゅ・

  * Python (繝舌・繧ｸ繝ｧ繝ｳ3.8莉･荳翫ｒ謗ｨ螂ｨ)

### 2\. 繝輔か繝ｫ繝讒区・

縺薙・繝・・繝ｫ縺ｯ縲∽ｻ･荳九・繝輔か繝ｫ繝讒区・繧貞燕謠舌→縺励※縺・∪縺吶・
```
phits-linac-validation/
笏・笏懌楳笏 糖 README.md
笏懌楳笏 塘 config.ini          <-- 笘・ｨｭ螳壹ヵ繧｡繧､繝ｫ
笏・笏懌楳笏 錐 src/
笏・  笏披楳笏 Comp_measured_phits_v9.1.py
笏・笏懌楳笏 投 data/
笏・  笏懌楳笏 phits_output/
笏・  笏披楳笏 measured_csv/
笏・笏披楳笏 嶋 output/
```

### 3\. 險ｭ螳壹ヵ繧｡繧､繝ｫ (`config.ini`)

繝励Ο繧ｸ繧ｧ繧ｯ繝医・繝ｫ繝ｼ繝医ョ繧｣繝ｬ繧ｯ繝医Μ縺ｫ`config.ini`繧剃ｽ懈・縺励∝推繝輔か繝ｫ繝縺ｮ繝代せ繧呈欠螳壹＠縺ｾ縺吶ゅ％繧後↓繧医ｊ縲√せ繧ｯ繝ｪ繝励ヨ縺ｯ縺ｩ縺薙↓繝・・繧ｿ縺後≠繧翫√←縺薙↓邨先棡繧剃ｿ晏ｭ倥☆繧後・繧医＞縺九ｒ謚頑升縺励∪縺吶・
**`config.ini` 縺ｮ蜀・ｮｹ萓・**

```ini
[Paths]
phits_data_dir = data/phits_output/
measured_data_dir = data/measured_csv/
output_dir = output/
```

### 4\. 繝ｩ繧､繝悶Λ繝ｪ縺ｮ繧､繝ｳ繧ｹ繝医・繝ｫ

繧ｿ繝ｼ繝溘リ繝ｫ縺ｧ繝励Ο繧ｸ繧ｧ繧ｯ繝医・繝ｫ繝ｼ繝医ヵ繧ｩ繝ｫ繝縺ｫ遘ｻ蜍輔＠縲∽ｻ･荳九・繧ｳ繝槭Φ繝峨ｒ螳溯｡後＠縺ｦ蠢・ｦ√↑繝ｩ繧､繝悶Λ繝ｪ繧偵う繝ｳ繧ｹ繝医・繝ｫ縺励∪縺吶・
```bash
pip install pandas numpy matplotlib scipy pymedphys
```

-----

## 菴ｿ縺・婿

繧ｹ繧ｯ繝ｪ繝励ヨ縺ｯ**蠢・★繝励Ο繧ｸ繧ｧ繧ｯ繝医・繝ｫ繝ｼ繝医ョ繧｣繝ｬ繧ｯ繝医Μ縺九ｉ螳溯｡後＠縺ｦ縺上□縺輔＞縲・*

### 繝｢繝ｼ繝・・壼ｯｾ隧ｱ繝｡繝九Η繝ｼ繝｢繝ｼ繝・束窶昨汳ｻ

蠑墓焚繧剃ｽ輔ｂ謖・ｮ壹○縺壹↓繧ｹ繧ｯ繝ｪ繝励ヨ繧貞ｮ溯｡後☆繧九→縲∝ｯｾ隧ｱ繝｢繝ｼ繝峨′襍ｷ蜍輔＠縺ｾ縺吶Ａconfig.ini`縺ｧ謖・ｮ壹＆繧後◆繝輔か繝ｫ繝蜀・°繧峨ヵ繧｡繧､繝ｫ繧帝∈謚槭〒縺阪∪縺吶・
```bash
# 繝励Ο繧ｸ繧ｧ繧ｯ繝医Ν繝ｼ繝医°繧牙ｮ溯｡・python src/Comp_measured_phits_v9.1.py
```

### 繝｢繝ｼ繝・・壹さ繝槭Φ繝峨Λ繧､繝ｳ蠑墓焚繝｢繝ｼ繝・噫

繧ｿ繝ｼ繝溘リ繝ｫ縺九ｉ**繝輔ぃ繧､繝ｫ蜷阪・縺ｿ**繧呈欠螳壹＠縺ｦ螳溯｡後＠縺ｾ縺吶ゅせ繧ｯ繝ｪ繝励ヨ縺ｯ`config.ini`繧貞・縺ｫ繝輔ぃ繧､繝ｫ縺ｮ繝輔Ν繝代せ繧定・蜍輔〒隗｣豎ｺ縺励∪縺吶・
#### 繧ｳ繝槭Φ繝峨・蝓ｺ譛ｬ讒矩

```bash
python src/Comp_measured_phits_v9.1.py [PHITS繝輔ぃ繧､繝ｫ蜷江 [螳滓ｸｬCSV繝輔ぃ繧､繝ｫ蜷江 [繧ｪ繝励す繝ｧ繝ｳ]
```

#### 蠑墓焚縺ｮ隱ｬ譏・
  * **蠢・亥ｼ墓焚:**

      * `phits_file`: PHITS縺ｮ蜃ｺ蜉・*繝輔ぃ繧､繝ｫ蜷・* (`.out`, `.dat`)
      * `measured_file`: 螳滓ｸｬ繝・・繧ｿ縺ｮ**繝輔ぃ繧､繝ｫ蜷・* (`.csv`)

  * **繧ｪ繝励す繝ｧ繝ｳ蠑墓焚:**

      * `--scale`: 繧ｹ繧ｱ繝ｼ繝ｪ繝ｳ繧ｰ菫よ焚 (萓・ `--scale 1.05`)
      * `--window`: 蟷ｳ貊大喧縺ｮ繧ｦ繧｣繝ｳ繝峨え蟷・(螂・焚) (萓・ `--window 7`)
      * `--order`: 蟷ｳ貊大喧縺ｮ螟夐・ｼ乗ｬ｡謨ｰ (萓・ `--order 3`)
      * `--dd`: 繧ｬ繝ｳ繝櫁ｩ穂ｾ｡縺ｮ邱夐㍼蟾ｮ(%)險ｱ螳ｹ蛟､ (萓・ `--dd 2.0`)
      * `--dta`: 繧ｬ繝ｳ繝櫁ｩ穂ｾ｡縺ｮ霍晞屬(mm)險ｱ螳ｹ蛟､ (萓・ `--dta 2.0`)
      * `--cutoff`: 繧ｬ繝ｳ繝櫁ｩ穂ｾ｡縺ｧ辟｡隕悶☆繧倶ｽ守ｷ夐㍼蝓・%) (萓・ `--cutoff 15.0`)
      * `--no-plot`: 繧ｰ繝ｩ繝輔ｒ逕ｻ髱｢縺ｫ陦ｨ遉ｺ縺帙★縺ｫ邨ゆｺ・☆繧九ヵ繝ｩ繧ｰ

#### 螳溯｡御ｾ・
```bash
# 繝励Ο繧ｸ繧ｧ繧ｯ繝医Ν繝ｼ繝医°繧牙ｮ溯｡・python src/Comp_measured_phits_v9.1.py deposit-z-water.out 10x10mPDD-zZver.csv --scale 1.02 --dd 2.0 --dta 2.0
```

-----

## 投 蜃ｺ蜉帙ヵ繧｡繧､繝ｫ

繧ｹ繧ｯ繝ｪ繝励ヨ繧貞ｮ溯｡後☆繧九→縲～config.ini`縺ｧ謖・ｮ壹＠縺歔output_dir`繝輔か繝ｫ繝縺ｮ荳ｭ縺ｫ縲∽ｻ･荳九・2遞ｮ鬘槭・繝輔ぃ繧､繝ｫ縺御ｿ晏ｭ倥＆繧後∪縺吶・
1.  **繧ｰ繝ｩ繝慕判蜒・(`output/plots/Comp_... .png`)**
      * 髱偵＞轤ｹ: 螳滓ｸｬ繝・・繧ｿ
      * 轣ｰ濶ｲ縺ｮ轤ｹ邱・ PHITS縺ｮ逕溘ョ繝ｼ繧ｿ・域ｭ｣隕丞喧縺ｮ縺ｿ・・      * 襍､縺・ｮ溽ｷ・ PHITS繝・・繧ｿ・医せ繧ｱ繝ｼ繝ｪ繝ｳ繧ｰ・・ｹｳ貊大喧驕ｩ逕ｨ蠕鯉ｼ・2.  **繝ｬ繝昴・繝・(`output/reports/Report_... .txt`)**
      * 菴ｿ逕ｨ縺励◆繝輔ぃ繧､繝ｫ蜷阪∬ｧ｣譫舌ヱ繝ｩ繝｡繝ｼ繧ｿ縲∬ｨ育ｮ励＆繧後◆RMSE縺ｨ繧ｬ繝ｳ繝槭ヱ繧ｹ邇・′險倬鹸縺輔ｌ縺ｾ縺吶・
-----

## 肌 譖ｴ譁ｰ螻･豁ｴ

#### Ver. 9.1.ROBUST_PATH (2025-09-04)
繧ｹ繧ｯ繝ｪ繝励ヨ縺ｮ螳牙ｮ壽ｧ縺ｨ莠呈鋤諤ｧ繧貞髄荳翫＆縺帙ｋ縺溘ａ縲∽ｻ･荳九・菫ｮ豁｣繧定｡後＞縺ｾ縺励◆縲・
*   **PHITS蜃ｺ蜉帙ヵ繧｡繧､繝ｫ縺ｮ隗｣譫仙・逅・ｒ蠑ｷ蛹・**
    *   PHITS縺ｮTally繧ｻ繧ｯ繧ｷ繝ｧ繝ｳ髢句ｧ九ｒ遉ｺ縺吶・繝ｼ繧ｫ繝ｼ (`[ T-Deposit ]`) 縺ｮ讀懷・蜃ｦ逅・ｒ謾ｹ蝟・ゅせ繝壹・繧ｹ縺ｮ譛臥┌繧・､ｧ譁・ｭ励・蟆乗枚蟄励・驕輔＞・井ｾ・ `[T-Deposit]`, `[ t - deposit ]`・峨′縺ゅ▲縺ｦ繧ゅ√そ繧ｯ繧ｷ繝ｧ繝ｳ繧呈ｭ｣縺励￥隱崎ｭ倥〒縺阪ｋ繧医≧縺ｫ縺ｪ繧翫∪縺励◆縲・    *   Tally繧ｻ繧ｯ繧ｷ繝ｧ繝ｳ蜀・・繝・・繧ｿ繝倥ャ繝繝ｼ縺ｨ繝・・繧ｿ譛ｬ菴薙・髢薙↓莠域悄縺帙〓遨ｺ陦後ｄ繧ｳ繝｡繝ｳ繝郁｡後′蟄伜惠縺励※繧ゅ√ョ繝ｼ繧ｿ繧呈沐霆溘↓隱ｭ縺ｿ蜿悶ｌ繧九ｈ縺・↓縺ｪ繧翫∪縺励◆縲・
*   **蠎ｧ讓呵ｻｸ縺ｮ莠呈鋤諤ｧ繧貞髄荳・**
    *   PHITS縺ｮ蠎ｧ讓咏ｳｻ縺ｨ螳滓ｸｬ繝・・繧ｿ縺ｮ蠎ｧ讓咏ｳｻ縺ｮ蟇ｾ蠢懊メ繧ｧ繝・け繧呈僑蠑ｵ縺励～x-x`, `y-y`, `z-z` 縺ｮ繧医≧縺ｫ蜷後§霆ｸ蜷悟｣ｫ縺ｮ邨・∩蜷医ｏ縺帙ｂ豁｣蟶ｸ縺ｪ豈碑ｼ・ｯｾ雎｡縺ｨ縺励※蜃ｦ逅・＆繧後ｋ繧医≧縺ｫ縺ｪ繧翫∪縺励◆縲・
*   **螳滓ｸｬ繝・・繧ｿCSV縺ｮ隱ｭ縺ｿ霎ｼ縺ｿ繧貞ｼｷ蛹・**
    *   CSV繝輔ぃ繧､繝ｫ縺ｮ繝倥ャ繝繝ｼ縺ｫ蜷ｫ縺ｾ繧後ｋ霆ｸ蜷搾ｼ井ｾ・ `X (cm)`・峨′縲∝ｰ乗枚蟄・(`x (cm)`) 縺ｧ險倩ｿｰ縺輔ｌ縺ｦ縺・※繧ゅ∝､ｧ譁・ｭ励・蟆乗枚蟄励ｒ蛹ｺ蛻･縺帙★縺ｫ霆ｸ繧定ｪ崎ｭ倥〒縺阪ｋ繧医≧縺ｫ縺ｪ繧翫∪縺励◆縲・
-----

## 繝ｩ繧､繧ｻ繝ｳ繧ｹ

縺薙・繝励Ο繧ｸ繧ｧ繧ｯ繝医・[MIT繝ｩ繧､繧ｻ繝ｳ繧ｹ](https://www.google.com/search?q=LICENSE)縺ｮ荳九〒蜈ｬ髢九＆繧後※縺・∪縺吶・# PHITS蛹ｻ逋ら畑繝ｪ繝九い繝・・ｽ・ｽ邱夐㍼蛻・・ｽ・ｽE・ｽ・ｽ萓｡繝・・ｽE繝ｫ

-----

驥崎ｦ・ 譁ｰ縺励＞逵溷､繧ｹ繧ｱ繝ｼ繝ｪ繝ｳ繧ｰCLI・域耳螂ｨ・・
PDD驥阪∩莉倥￠縺ｮ窶懃悄蛟､窶昴せ繧ｱ繝ｼ繝ｪ繝ｳ繧ｰ縺ｧOCR繧呈ｯ碑ｼ・☆繧区眠CLI繧定ｿｽ蜉縺励∪縺励◆縲ゅ％繧後・ project.md 縺ｧ螳夂ｾｩ縺輔ｌ縺・True(x,z) = PDD_norm(z) ﾃ・OCR_rel(x,z) 縺ｫ蝓ｺ縺･縺阪∃ｳ/RMSE繧堤悄蛟､繧ｹ繧ｱ繝ｼ繝ｫ荳翫〒隧穂ｾ｡縺励∪縺吶・
- 繧ｨ繝ｳ繝医Μ: `python src/ocr_true_scaling.py`
- 蜈･蜉幢ｼ亥ｯｾ遘ｰ繝ｻ豺ｷ蝨ｨ蜿ｯ・・ reference/eval 縺ｨ繧ゅ↓ CSV 縺ｾ縺溘・ PHITS `.out`
- PDD豁｣隕丞喧: 譌｢螳・dmax縲・∈謚櫁い z_ref=10 cm
- OCR荳ｭ蠢・ｭ｣隕丞喧: x=0 譛霑大ｍ・按ｱ0.05 cm・俄・辟｡縺代ｌ縺ｰ譛螟ｧ蛟､
- 謖・ｨ・ ﾎｳ・井ｸｻ隕・2%/2mm/10%縲∝憶谺｡ 3%/3mm/10%・峨ヽMSE
- 蜃ｺ蜉・ `output/plots/*.png`, `output/reports/*.txt`, 蠢・ｦ√↓蠢懊§ `output/data/*.csv`

菴ｿ逕ｨ萓具ｼ・eference=CSV, eval=PHITS, 10 cm・・
```bash
python src/ocr_true_scaling.py \
  --ref-pdd-type csv  --ref-pdd-file data/measured_csv/10x10mPDD-zZver.csv \
  --eval-pdd-type phits --eval-pdd-file data/phits_output/deposit-z-water.out \
  --ref-ocr-type csv   --ref-ocr-file data/measured_csv/10x10m10cm-xXlat.csv \
  --eval-ocr-type phits --eval-ocr-file data/phits_output/I600/deposit-y-water-100.out \
  --norm-mode dmax --cutoff 10 --export-csv --export-gamma
```

繧ｪ繝励す繝ｧ繝ｳ
- `--grid <cm>`: RMSE/蜿ｯ隕門喧縺ｮ蜈ｱ騾壹げ繝ｪ繝・ラ蛻ｻ縺ｿ・域里螳・ `config.ini` 縺ｮ `[Processing].resample_grid_cm`・・- `--ymin/--ymax`: 繝励Ο繝・ヨ縺ｮY霆ｸ遽・峇
- `--xlim-symmetric`: 讓ｪ霆ｸ繧貞次轤ｹ蟇ｾ遘ｰ縺ｫ險ｭ螳・- `--legend-ref/--legend-eval`: 蜃｡萓九Λ繝吶Ν繧剃ｻｻ諢乗欠螳・- `--export-csv/--export-gamma`: 逵溷､邉ｻ蛻・ﾎｳ驟榊・繧辰SV菫晏ｭ・
繝ｬ繧ｬ繧ｷ繝ｼ莠呈鋤
- 蠕捺擂縺ｮ `src/Comp_measured_phits_v9.1.py` 縺ｯ繝ｩ繝・ヱ繝ｼ縺ｨ縺ｪ繧翫～src/Comp_measured_phits_v9_1_legacy.py` 縺ｫ蟋碑ｭｲ縺輔ｌ縺ｾ縺吶・
-----

